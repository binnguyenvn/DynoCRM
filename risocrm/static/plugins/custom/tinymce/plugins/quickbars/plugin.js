!function(e){"use strict";var n,r,t,o,i=tinymce.util.Tools.resolve("tinymce.PluginManager"),u=0,s=function(e,n,r){e.plugins.table?e.plugins.table.insertTable(n,r):function(e,n,r){e.undoManager.transact(function(){var t,o;e.insertContent(function(e,n){var r,t,o;for(o='<table data-mce-id="mce" style="width: 100%">',o+="<tbody>",t=0;t<n;t++){for(o+="<tr>",r=0;r<e;r++)o+="<td><br></td>";o+="</tr>"}return o+="</tbody>",o+="</table>"}(n,r)),(t=function(e){return e.dom.select("*[data-mce-id]")[0]}(e)).removeAttribute("data-mce-id"),o=e.dom.select("td,th",t),e.selection.setCursorLocation(o[0],0)})}(e,n,r)},c=function(e,n,r){var t,o,i,s;o=(t=e.editorUpload.blobCache).create((i="mceu",s=(new Date).getTime(),i+"_"+Math.floor(1e9*Math.random())+ ++u+String(s)),r,n),t.add(o),e.insertContent(e.dom.createHTML("img",{src:o.blobUri()}))},a=tinymce.util.Tools.resolve("tinymce.util.Promise"),f=function(n){return new a(function(r){var t=new e.FileReader;t.onloadend=function(){r(t.result.split(",")[1])},t.readAsDataURL(n)})},d=tinymce.util.Tools.resolve("tinymce.Env"),l=tinymce.util.Tools.resolve("tinymce.util.Delay"),m=function(n){return new a(function(r){var t=e.document.createElement("input");t.type="file",t.style.position="fixed",t.style.left="0",t.style.top="0",t.style.opacity="0.001",e.document.body.appendChild(t),t.addEventListener("change",function(e){r(Array.prototype.slice.call(e.target.files))});var o=function(e){var i=function(){r([]),t.parentNode.removeChild(t)};d.os.isAndroid()&&"remove"!==e.type?l.setEditorTimeout(n,i,0):i(),n.off("focusin remove",o)};n.on("focusin remove",o),t.click()})},v={setupButtons:function(e){e.ui.registry.addButton("quickimage",{icon:"image",tooltip:"Insert image",onAction:function(){m(e).then(function(n){if(n.length>0){var r=n[0];f(r).then(function(n){c(e,n,r)})}})}}),e.ui.registry.addButton("quicktable",{icon:"table",tooltip:"Insert table",onAction:function(){s(e,2,2)}})}},g=function(){},h=function(e){return function(){return e}},p=h(!1),N=h(!0),O=function(){return E},E=(n=function(e){return e.isNone()},o={fold:function(e,n){return e()},is:p,isSome:p,isNone:N,getOr:t=function(e){return e},getOrThunk:r=function(e){return e()},getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:h(null),getOrUndefined:h(void 0),or:t,orThunk:r,map:O,each:g,bind:O,exists:p,forall:N,filter:O,equals:n,equals_:n,toArray:function(){return[]},toString:h("none()")},Object.freeze&&Object.freeze(o),o),b=function(e){var n=h(e),r=function(){return o},t=function(n){return n(e)},o={fold:function(n,r){return r(e)},is:function(n){return e===n},isSome:N,isNone:p,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:r,orThunk:r,map:function(n){return b(n(e))},each:function(n){n(e)},bind:t,exists:t,forall:t,filter:function(n){return n(e)?o:E},toArray:function(){return[e]},toString:function(){return"some("+e+")"},equals:function(n){return n.is(e)},equals_:function(n,r){return n.fold(p,function(n){return r(e,n)})}};return o},T={some:b,none:O,from:function(e){return null==e?E:b(e)}},w=function(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:h(e)}},S={fromHtml:function(n,r){var t=(r||e.document).createElement("div");if(t.innerHTML=n,!t.hasChildNodes()||t.childNodes.length>1)throw e.console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return w(t.childNodes[0])},fromTag:function(n,r){var t=(r||e.document).createElement(n);return w(t)},fromText:function(n,r){var t=(r||e.document).createTextNode(n);return w(t)},fromDom:w,fromPoint:function(e,n,r){var t=e.dom();return T.from(t.elementFromPoint(n,r)).map(w)}},y=(e.Node.ATTRIBUTE_NODE,e.Node.CDATA_SECTION_NODE,e.Node.COMMENT_NODE,e.Node.DOCUMENT_NODE,e.Node.DOCUMENT_TYPE_NODE,e.Node.DOCUMENT_FRAGMENT_NODE,e.Node.ELEMENT_NODE),x=(e.Node.TEXT_NODE,e.Node.PROCESSING_INSTRUCTION_NODE,e.Node.ENTITY_REFERENCE_NODE,e.Node.ENTITY_NODE,e.Node.NOTATION_NODE,void 0!==e.window?e.window:Function("return this;")(),function(e){return function(n){return function(e){if(null===e)return"null";var n=typeof e;return"object"===n&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"===n&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":n}(n)===e}}),D=x("string"),k=x("object"),_=x("array"),C=x("boolean"),A=x("undefined"),M=x("function"),R=Array.prototype.slice;M(Array.from)&&Array.from;function I(e,n,r,t,o){return e(r,t)?T.some(r):M(o)&&o(r)?T.none():n(r,t,o)}var q,L=function(e,n,r){return 0!=(e.compareDocumentPosition(n)&r)},F=function(n,r){return L(n,r,e.Node.DOCUMENT_POSITION_CONTAINED_BY)},P=function(e){var n=e,r=function(){return n};return{get:r,set:function(e){n=e},clone:function(){return P(r())}}},B=function(){return U(0,0)},U=function(e,n){return{major:e,minor:n}},j={nu:U,detect:function(e,n){var r=String(n).toLowerCase();return 0===e.length?B():function(e,n){var r=function(e,n){for(var r=0;r<e.length;r++){var t=e[r];if(t.test(n))return t}}(e,n);if(!r)return{major:0,minor:0};var t=function(e){return Number(n.replace(r,"$"+e))};return U(t(1),t(2))}(e,r)},unknown:B},H=function(e,n){return function(){return n===e}},W=function(e){var n=e.current;return{current:n,version:e.version,isEdge:H("Edge",n),isChrome:H("Chrome",n),isIE:H("IE",n),isOpera:H("Opera",n),isFirefox:H("Firefox",n),isSafari:H("Safari",n)}},X={unknown:function(){return W({current:void 0,version:j.unknown()})},nu:W,edge:h("Edge"),chrome:h("Chrome"),ie:h("IE"),opera:h("Opera"),firefox:h("Firefox"),safari:h("Safari")},z=function(e,n){return function(){return n===e}},G=function(e){var n=e.current;return{current:n,version:e.version,isWindows:z("Windows",n),isiOS:z("iOS",n),isAndroid:z("Android",n),isOSX:z("OSX",n),isLinux:z("Linux",n),isSolaris:z("Solaris",n),isFreeBSD:z("FreeBSD",n)}},Y={unknown:function(){return G({current:void 0,version:j.unknown()})},nu:G,windows:h("Windows"),ios:h("iOS"),android:h("Android"),linux:h("Linux"),osx:h("OSX"),solaris:h("Solaris"),freebsd:h("FreeBSD")},$=function(e,n){var r=String(n).toLowerCase();return function(e,n){for(var r=0,t=e.length;r<t;r++){var o=e[r];if(n(o,r))return T.some(o)}return T.none()}(e,function(e){return e.search(r)})},V=function(e,n){return $(e,n).map(function(e){var r=j.detect(e.versionRegexes,n);return{current:e.name,version:r}})},J=function(e,n){return $(e,n).map(function(e){var r=j.detect(e.versionRegexes,n);return{current:e.name,version:r}})},K=function(e,n){return-1!==e.indexOf(n)},Q=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Z=function(e){return function(n){return K(n,e)}},ee=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return K(e,"edge/")&&K(e,"chrome")&&K(e,"safari")&&K(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Q],search:function(e){return K(e,"chrome")&&!K(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return K(e,"msie")||K(e,"trident")}},{name:"Opera",versionRegexes:[Q,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Z("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Z("firefox")},{name:"Safari",versionRegexes:[Q,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(K(e,"safari")||K(e,"mobile/"))&&K(e,"applewebkit")}}],ne=[{name:"Windows",search:Z("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return K(e,"iphone")||K(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Z("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Z("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Z("linux"),versionRegexes:[]},{name:"Solaris",search:Z("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Z("freebsd"),versionRegexes:[]}],re={browsers:h(ee),oses:h(ne)},te=function(e,n){var r=re.browsers(),t=re.oses(),o=V(r,e).fold(X.unknown,X.nu),i=J(t,e).fold(Y.unknown,Y.nu),u=function(e,n,r,t){var o=e.isiOS()&&!0===/ipad/i.test(r),i=e.isiOS()&&!o,u=e.isiOS()||e.isAndroid(),s=u||t("(pointer:coarse)"),c=o||!i&&u&&t("(min-device-width:768px)"),a=i||u&&!c,f=n.isSafari()&&e.isiOS()&&!1===/safari/i.test(r),d=!a&&!c&&!f;return{isiPad:h(o),isiPhone:h(i),isTablet:h(c),isPhone:h(a),isTouch:h(s),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:h(f),isDesktop:h(d)}}(i,o,e,n);return{browser:o,os:i,deviceType:u}},oe=P(te(e.navigator.userAgent,function(n){return e.window.matchMedia(n).matches})),ie=y,ue=function(e,n){var r=e.dom();if(r.nodeType!==ie)return!1;var t=r;if(void 0!==t.matches)return t.matches(n);if(void 0!==t.msMatchesSelector)return t.msMatchesSelector(n);if(void 0!==t.webkitMatchesSelector)return t.webkitMatchesSelector(n);if(void 0!==t.mozMatchesSelector)return t.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")},se=(oe.get().browser.isIE(),function(e,n,r){for(var t=e.dom(),o=M(r)?r:h(!1);t.parentNode;){t=t.parentNode;var i=S.fromDom(t);if(n(i))return T.some(i);if(o(i))break}return T.none()}),ce=function(e,n,r){return se(e,function(e){return ue(e,n)},r)},ae={getToolbarItemsOr:(q=D,function(e,n,r){return function(e,n){if(n(e))return!0;throw new Error("Default value doesn't match requested type.")}(r,q),function(e,n){if(_(e)||k(e))throw new Error("expected a string but found: "+e);return A(e)?n:C(e)?!1===e?"":n:e}(e.getParam(n,r),r)})},fe=function(e){return ae.getToolbarItemsOr(e,"quickbars_selection_toolbar","bold italic | quicklink h2 h3 blockquote")},de=function(e){return ae.getToolbarItemsOr(e,"quickbars_insert_toolbar","quickimage quicktable")},le={addToEditor:function(e){var n=de(e);n.trim().length>0&&e.ui.registry.addContextToolbar("quickblock",{predicate:function(n){var r=S.fromDom(n),t=e.schema.getTextBlockElements(),o=function(n){return n.dom()===e.getBody()};return function(e,n,r){return I(ue,ce,e,n,r)}(r,"table",o).fold(function(){return function(e,n,r){return I(function(e,n){return n(e)},se,e,n,r)}(r,function(n){return n.dom().nodeName.toLowerCase()in t&&e.dom.isEmpty(n.dom())},o).isSome()},function(){return!1})},items:n,position:"line",scope:"editor"})}},me={addToEditor:function(e){e.ui.registry.addContextToolbar("imageselection",{predicate:function(e){return"IMG"===e.nodeName||"FIGURE"===e.nodeName&&/image/i.test(e.className)},items:"alignleft aligncenter alignright",position:"node"});var n=fe(e);n.trim().length>0&&e.ui.registry.addContextToolbar("textselection",{predicate:function(n){return!e.selection.isCollapsed()},items:n,position:"selection"})}};i.add("quickbars",function(e){v.setupButtons(e),le.addToEditor(e),me.addToEditor(e)})}(window);