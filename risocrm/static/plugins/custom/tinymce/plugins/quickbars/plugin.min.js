!function(e){"use strict";function n(e){return function(){return e}}function r(){return m}var t,o=tinymce.util.Tools.resolve("tinymce.PluginManager"),i=0,u=function(e,n,r){var t,o;o=(t=e.editorUpload.blobCache).create(function(e){var n=(new Date).getTime();return"mceu_"+Math.floor(1e9*Math.random())+ ++i+String(n)}(),r,n),t.add(o),e.insertContent(e.dom.createHTML("img",{src:o.blobUri()}))},s=tinymce.util.Tools.resolve("tinymce.util.Promise"),c=tinymce.util.Tools.resolve("tinymce.Env"),a=tinymce.util.Tools.resolve("tinymce.util.Delay"),f=function(n){n.ui.registry.addButton("quickimage",{icon:"image",tooltip:"Insert image",onAction:function(){var r;(r=n,new s(function(n){var t=e.document.createElement("input");t.type="file",t.style.position="fixed",t.style.left="0",t.style.top="0",t.style.opacity="0.001",e.document.body.appendChild(t),t.addEventListener("change",function(e){n(Array.prototype.slice.call(e.target.files))});var o=function(e){function i(){n([]),t.parentNode.removeChild(t)}c.os.isAndroid()&&"remove"!==e.type?a.setEditorTimeout(r,i,0):i(),r.off("focusin remove",o)};r.on("focusin remove",o),t.click()})).then(function(r){if(0<r.length){var t=r[0];(function(n){return new s(function(r){var t=new e.FileReader;t.onloadend=function(){r(t.result.split(",")[1])},t.readAsDataURL(n)})})(t).then(function(e){u(n,e,t)})}})}}),n.ui.registry.addButton("quicktable",{icon:"table",tooltip:"Insert table",onAction:function(){!function(e,n,r){e.plugins.table?e.plugins.table.insertTable(n,r):function(e,n,r){e.undoManager.transact(function(){var t,o;e.insertContent(function(e,n){var r,t,o;for(o='<table data-mce-id="mce" style="width: 100%">',o+="<tbody>",t=0;t<n;t++){for(o+="<tr>",r=0;r<e;r++)o+="<td><br></td>";o+="</tr>"}return(o+="</tbody>")+"</table>"}(n,r)),(t=e.dom.select("*[data-mce-id]")[0]).removeAttribute("data-mce-id"),o=e.dom.select("td,th",t),e.selection.setCursorLocation(o[0],0)})}(e,n,r)}(n,2,2)}})},d=n(!1),l=n(!0),m=(t={fold:function(e,n){return e()},is:d,isSome:d,isNone:l,getOr:h,getOrThunk:g,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:n(null),getOrUndefined:n(void 0),or:h,orThunk:g,map:r,each:function(){},bind:r,exists:d,forall:l,filter:r,equals:v,equals_:v,toArray:function(){return[]},toString:n("none()")},Object.freeze&&Object.freeze(t),t);function v(e){return e.isNone()}function g(e){return e()}function h(e){return e}function p(e){return function(n){return function(e){if(null===e)return"null";var n=typeof e;return"object"==n&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"==n&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":n}(n)===e}}var O=function(e){function r(){return i}function t(n){return n(e)}var o=n(e),i={fold:function(n,r){return r(e)},is:function(n){return e===n},isSome:l,isNone:d,getOr:o,getOrThunk:o,getOrDie:o,getOrNull:o,getOrUndefined:o,or:r,orThunk:r,map:function(n){return O(n(e))},each:function(n){n(e)},bind:t,exists:t,forall:t,filter:function(n){return n(e)?i:m},toArray:function(){return[e]},toString:function(){return"some("+e+")"},equals:function(n){return n.is(e)},equals_:function(n,r){return n.fold(d,function(n){return r(e,n)})}};return i},b={some:O,none:r,from:function(e){return null==e?m:O(e)}},N=function(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:n(e)}},E={fromHtml:function(n,r){var t=(r||e.document).createElement("div");if(t.innerHTML=n,!t.hasChildNodes()||1<t.childNodes.length)throw e.console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return N(t.childNodes[0])},fromTag:function(n,r){var t=(r||e.document).createElement(n);return N(t)},fromText:function(n,r){var t=(r||e.document).createTextNode(n);return N(t)},fromDom:N,fromPoint:function(e,n,r){var t=e.dom();return b.from(t.elementFromPoint(n,r)).map(N)}},T=(e.Node.ATTRIBUTE_NODE,e.Node.CDATA_SECTION_NODE,e.Node.COMMENT_NODE,e.Node.DOCUMENT_NODE,e.Node.DOCUMENT_TYPE_NODE,e.Node.DOCUMENT_FRAGMENT_NODE,e.Node.ELEMENT_NODE),y=(e.Node.TEXT_NODE,e.Node.PROCESSING_INSTRUCTION_NODE,e.Node.ENTITY_REFERENCE_NODE,e.Node.ENTITY_NODE,e.Node.NOTATION_NODE,void 0!==e.window?e.window:Function("return this;")(),p("string")),w=p("object"),S=p("array"),x=p("boolean"),D=p("undefined"),_=p("function");Array.prototype.slice;function C(e,n,r,t,o){return e(r,t)?b.some(r):_(o)&&o(r)?b.none():n(r,t,o)}function k(e,n){return function(){return n===e}}function A(e,n){return function(){return n===e}}function R(e,n){var r=String(n).toLowerCase();return function(e,n){for(var r=0,t=e.length;r<t;r++){var o=e[r];if(n(o))return b.some(o)}return b.none()}(e,function(e){return e.search(r)})}function M(e,n){return-1!==e.indexOf(n)}function I(e){return function(n){return M(n,e)}}function q(e,n){var r=e.dom();if(r.nodeType!==ue)return!1;var t=r;if(void 0!==t.matches)return t.matches(n);if(void 0!==t.msMatchesSelector)return t.msMatchesSelector(n);if(void 0!==t.webkitMatchesSelector)return t.webkitMatchesSelector(n);if(void 0!==t.mozMatchesSelector)return t.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")}function L(e,r,t){for(var o=e.dom(),i=_(t)?t:n(!1);o.parentNode;){o=o.parentNode;var u=E.fromDom(o);if(r(u))return b.some(u);if(i(u))break}return b.none()}function F(e,n,r){return L(e,function(e){return q(e,n)},r)}_(Array.from)&&Array.from;var P,U=function(e){function n(){return r}var r=e;return{get:n,set:function(e){r=e},clone:function(){return U(n())}}},B=function(){return j(0,0)},j=function(e,n){return{major:e,minor:n}},H=function(e,n){var r=String(n).toLowerCase();return 0===e.length?B():function(e,n){var r=function(e,n){for(var r=0;r<e.length;r++){var t=e[r];if(t.test(n))return t}}(e,n);if(!r)return{major:0,minor:0};function t(e){return Number(n.replace(r,"$"+e))}return j(t(1),t(2))}(e,r)},X=B,z="Firefox",G=function(e){var n=e.current;return{current:n,version:e.version,isEdge:k("Edge",n),isChrome:k("Chrome",n),isIE:k("IE",n),isOpera:k("Opera",n),isFirefox:k(z,n),isSafari:k("Safari",n)}},W=function(){return G({current:void 0,version:X()})},Y=G,$=(n("Edge"),n("Chrome"),n("IE"),n("Opera"),n(z),n("Safari"),"Windows"),V="Android",J="Solaris",K="FreeBSD",Q=function(e){var n=e.current;return{current:n,version:e.version,isWindows:A($,n),isiOS:A("iOS",n),isAndroid:A(V,n),isOSX:A("OSX",n),isLinux:A("Linux",n),isSolaris:A(J,n),isFreeBSD:A(K,n)}},Z=function(){return Q({current:void 0,version:X()})},ee=Q,ne=(n($),n("iOS"),n(V),n("Linux"),n("OSX"),n(J),n(K),/.*?version\/\ ?([0-9]+)\.([0-9]+).*/),re=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return M(e,"edge/")&&M(e,"chrome")&&M(e,"safari")&&M(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,ne],search:function(e){return M(e,"chrome")&&!M(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return M(e,"msie")||M(e,"trident")}},{name:"Opera",versionRegexes:[ne,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:I("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:I("firefox")},{name:"Safari",versionRegexes:[ne,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(M(e,"safari")||M(e,"mobile/"))&&M(e,"applewebkit")}}],te=[{name:"Windows",search:I("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return M(e,"iphone")||M(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:I("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:I("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:I("linux"),versionRegexes:[]},{name:"Solaris",search:I("sunos"),versionRegexes:[]},{name:"FreeBSD",search:I("freebsd"),versionRegexes:[]}],oe={browsers:n(re),oses:n(te)},ie=U(function(r,t){var o=oe.browsers(),i=oe.oses(),u=function(e,n){return R(e,n).map(function(e){var r=H(e.versionRegexes,n);return{current:e.name,version:r}})}(o,r).fold(W,Y),s=function(e,n){return R(e,n).map(function(e){var r=H(e.versionRegexes,n);return{current:e.name,version:r}})}(i,r).fold(Z,ee);return{browser:u,os:s,deviceType:function(e,r,t,o){var i=e.isiOS()&&!0===/ipad/i.test(t),u=e.isiOS()&&!i,s=e.isiOS()||e.isAndroid(),c=s||o("(pointer:coarse)"),a=i||!u&&s&&o("(min-device-width:768px)"),f=u||s&&!a,d=r.isSafari()&&e.isiOS()&&!1===/safari/i.test(t),l=!f&&!a&&!d;return{isiPad:n(i),isiPhone:n(u),isTablet:n(a),isPhone:n(f),isTouch:n(c),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:n(d),isDesktop:n(l)}}(s,u,r,function(n){return e.window.matchMedia(n).matches})}}(e.navigator.userAgent)),ue=T,se=(ie.get().browser.isIE(),{getToolbarItemsOr:(P=y,function(e,n,r){return function(e,n){if(!P(r))throw new Error("Default value doesn't match requested type.")}(),function(e,n){if(S(e)||w(e))throw new Error("expected a string but found: "+e);return D(e)?n:x(e)?!1===e?"":n:e}(e.getParam(n,r),r)})}),ce=function(e){var n=function(e){return se.getToolbarItemsOr(e,"quickbars_insert_toolbar","quickimage quicktable")}(e);0<n.trim().length&&e.ui.registry.addContextToolbar("quickblock",{predicate:function(n){function r(n){return n.dom()===e.getBody()}var t=E.fromDom(n),o=e.schema.getTextBlockElements();return function(e,n,r){return C(q,F,e,"table",r)}(t,0,r).fold(function(){return function(n,r,t){return C(function(e,n){return n(e)},L,n,function(n){return function(e){return e.dom().nodeName.toLowerCase()}(n)in o&&e.dom.isEmpty(n.dom())},t)}(t,0,r).isSome()},function(){return!1})},items:n,position:"line",scope:"editor"})},ae=function(e){e.ui.registry.addContextToolbar("imageselection",{predicate:function(e){return"IMG"===e.nodeName||"FIGURE"===e.nodeName&&/image/i.test(e.className)},items:"alignleft aligncenter alignright",position:"node"});var n=function(e){return se.getToolbarItemsOr(e,"quickbars_selection_toolbar","bold italic | quicklink h2 h3 blockquote")}(e);0<n.trim().length&&e.ui.registry.addContextToolbar("textselection",{predicate:function(n){return!e.selection.isCollapsed()},items:n,position:"selection"})};o.add("quickbars",function(e){f(e),ce(e),ae(e)})}(window);